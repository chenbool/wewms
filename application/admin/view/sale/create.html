<!-- create begin -->
<div class="create">
   
    <!-- 表单 -->   
    <section class="panel-body" >
        <form role="form" class="form-create">

            <div class="form-group col-sm-12">
                <span>编号</span>
                <input type="text" class="form-control" placeholder="编号" name="sn" value="{:date('Ymdhis').rand(100,999)}">
            </div>

            <div class="form-group col-sm-6">
                <span>销售人</span>
                <input type="text" class="form-control" placeholder="名称" name="name" value="{$admin_user.nickname}">
            </div>

            <div class="form-group col-sm-6">
                <span>客户</span>
                <select name="supplier" class="form-control comboSelect">
                    {volist name="supplier" id="vo"}
                        <option value="{$vo.id}" >{$vo.title}</option>
                    {/volist}
                </select>
            </div>

<!-- 
            <div class="form-group col-sm-12">
                <span>状态</span>
                <div class="radio">
                    <label><input type="radio" name="status" value="0" checked="checked">正常</label>
                </div>
                <div class="radio">
                    <label><input type="radio" name="status" value="1" >作废</label>
                </div>
            </div>
-->
            <!-- select table -->
            <div class="form-group col-sm-12" style="height:350px;">           
                <table class="table table-bordered table-striped table-condensed no-margin col-sm-12" >
                    <thead>
                        <tr>
                            <th>
                                <i class="fa fa-plus btn btn-xs" @click="addLine"></i>
                            </th>
                            <th v-for="item in data" v-text="item"></th>
                            <th> 删除 </th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr v-for="(item,k) in list">
                            <td></td>
                            <td> 
                                <span v-text="item.name"></span>
                            </td>
                            <td> 
                                <span v-text="item.model"></span>
                            </td>
                            <td> 
                                <span v-text="item.spec"></span>
                            </td>
                            <td> 
                                <span v-text="item.color.name"></span>
                            </td>
                            <td> 
                                <input type="text" class="form-control" v-model="item.num" style="height:25px;width:60px;padding:3px;" >
                            </td>
                            <td> 
                                <span v-text="item.unit.name"></span>
                            </td>
                            <td> 
                                <input type="text" class="form-control" v-model="item.price" style="height:25px;width:60px;padding:3px;" >
                            </td>

                            <td >
                                <i class="fa fa-trash btn btn-xs" @click="delLine(k)"></i>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>



            <div class="form-group col-sm-12">
                <button type="button" class="btn btn-sm btn btn-primary" @click="save"> 保 存 </button>
                <button type="reset" class="btn btn-sm btn-success ">  重 置 </button> 
            </div>

        </form>
    </section>

</div>
<!-- create end-->


<script>
 var list = [];
 var layer_index = 0;
 
// seajs
seajs.use(['vendor/comboSelect/jquery.combo.select'], function() {

        var data = {
            name: '名称',
            model: '型号',
            spec: '规格',
            color: '颜色',
            num: '数量',
            unit: '单位',
            price: '单价',
        };

    // vue
    var create = new Vue({
        el: '.create',
        data: {
            data: data,
            list: list
        },
        mounted: function (){
            $('.comboSelect').comboSelect();
        },
        methods: {
            save: function () {
                var param = $('.form-create').serializeArray();
                this._save(param,"{:url('save')}")
            },
            addLine:function(){
                $.get("{:url('product/select')}", function(data) {
                    layer_index = layer.open({
                        type: 1,
                    　　title: "选择产品",
                    　　shadeClose: true,
                    　　shade: 0.4,
                        anim: 5,
                        area: ['80%','400px'],
                    　　content: data
                    });
                });

            },
            delLine:function(index){
                this.list.splice(index,1);
                // delete this.list[index];
            }

        }

    });

        
});

</script>