<!-- create begin -->
<div class=" create">
   
    <!-- 表单 -->   
    <section class="panel-body" >
            <form role="form" class="form-create">

                <div class="form-group col-sm-6">
                    <span>编号</span>
                    <input type="text" class="form-control" placeholder="编号" name="sn" value="{:date('Ymdhis').rand(100,999)}">
                </div>

                <div class="form-group col-sm-6">
                    <span>入库类型</span>
                    <select name="supplier" class="form-control comboSelect" >
                        <option value="1" >采购入库</option>
                        <option value="2" >手动入库</option>
                    </select>
                </div>

                <div class="form-group col-sm-12">
                    <span>关联订单</span>
                    <input type="text" class="form-control" placeholder="关联订单" name="author">
                </div>

                <div class="form-group col-sm-6">
                    <span>入库人</span>
                    <input type="text" class="form-control" placeholder="入库人" name="author" value="{$admin_user.nickname}">
                </div>

                <div class="form-group col-sm-6">
                    <span>供应商</span>
                    <select name="supplier" class="form-control comboSelect" >
                        {volist name="supplier" id="vo"}
                            <option value="{$vo.id}" >{$vo.title}</option>
                        {/volist}
                    </select>
                </div>                


                <div class="form-group col-sm-12">
                    <button type="button" class="btn btn-sm btn btn-primary" @click="save">  保 存 </button>
                    <button type="reset" class="btn btn-sm btn-success ">  重 置 </button> 
                </div>

            </form>
    </section>

</div>
<!-- create end-->

<script>

// seajs
seajs.use(['vendor/comboSelect/jquery.combo.select','vendor/laydate/laydate'],function() {

    var create = new Vue({
        el: '.form-create',
        data: {},
        mounted: function (){
            $('.comboSelect').comboSelect();
            // laydate.render({
            //     elem: '#purchase_date',
            //     theme: '#2DCB73'
            // });
        },
        methods: {
            save: function () {
                var param = $('.form-create').serializeArray();
                $.ajax({
                    url: "{:url('save')}",
                    method: 'POST',
                    dataType: 'json',
                    data: param,
                    success: this.callback
                });
            },
            callback:function (data) {
                if( data.error >0 ){
                    toastr.error(data.msg);
                }else{
                    toastr.success(data.msg);
                    Table.methods.refresh();
                    layer.closeAll('page');
                }
            }
        }

    });

});

</script>